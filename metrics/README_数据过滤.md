# æ•°æ®è¿‡æ»¤åŠŸèƒ½ä½¿ç”¨è¯´æ˜

## æ¦‚è¿°

æœ¬ç³»ç»Ÿæä¾›äº†æ™ºèƒ½çš„æ•°æ®è¿‡æ»¤åŠŸèƒ½ï¼Œèƒ½å¤Ÿæ ¹æ®ä¸åŒçš„æµ‹è¯•ç±»å‹è‡ªåŠ¨è¿‡æ»¤æ‰æ— æ•ˆçš„æ•°æ®æŒ‡æ ‡ï¼Œå¤§å¹…å‡å°‘æ–‡ä»¶å¤§å°å¹¶æé«˜æ•°æ®åˆ†ææ•ˆç‡ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### ğŸ¯ æ™ºèƒ½è¿‡æ»¤è§„åˆ™
- **è¿æ¥æµ‹è¯•**: è‡ªåŠ¨ç§»é™¤pubç›¸å…³æŒ‡æ ‡ï¼ˆpub_fail, pub_overrun, pub_succç­‰ï¼‰
- **å‘å¸ƒæµ‹è¯•**: è‡ªåŠ¨ç§»é™¤subç›¸å…³æŒ‡æ ‡ï¼ˆsub_fail, sub, reconnect_succç­‰ï¼‰
- **è®¢é˜…æµ‹è¯•**: è‡ªåŠ¨ç§»é™¤pubç›¸å…³æŒ‡æ ‡ï¼ˆpub_fail, pub_overrun, pub_succç­‰ï¼‰
- **å¹¿æ’­æµ‹è¯•**: è‡ªåŠ¨ç§»é™¤æ— æ„ä¹‰æŒ‡æ ‡ï¼ˆconnect_retriedç­‰ï¼‰

### ğŸ§¹ é€šç”¨è¿‡æ»¤è§„åˆ™
- ç§»é™¤Erlang VMç³»ç»ŸæŒ‡æ ‡ï¼ˆä¸MQTTæµ‹è¯•æ€§èƒ½æ— å…³ï¼‰
- ç§»é™¤é›¶å€¼ç›´æ–¹å›¾æ¡¶æ•°æ®
- ç§»é™¤é‡å¤çš„help_text
- ç§»é™¤é›¶å€¼ä¸”éå…³é”®æŒ‡æ ‡

### ğŸ“Š è¿‡æ»¤æ•ˆæœ
- **æ–‡ä»¶å¤§å°å‡å°‘**: çº¦97%ï¼ˆä»33MBå‡å°‘åˆ°650KB-1MBï¼‰
- **æŒ‡æ ‡æ•°é‡å‡å°‘**: ä»83,636ä¸ªæŒ‡æ ‡å‡å°‘åˆ°2,204-3,248ä¸ªæŒ‡æ ‡
- **ä¿ç•™å…³é”®æŒ‡æ ‡**: è¿æ¥æˆåŠŸç‡ã€å‘å¸ƒæˆåŠŸç‡ã€æ¥æ”¶æ•°é‡ã€å»¶è¿Ÿç­‰

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: é›†æˆåˆ°ä¸»ç¨‹åº
è¿è¡Œä¸»ç¨‹åºæ—¶ï¼Œæ•°æ®è¿‡æ»¤ä¼šè‡ªåŠ¨æ‰§è¡Œï¼š

```bash
cd /Users/admin/Workspace/python/emqtt-bench-huawei/metrics
python3 main.py
# é€‰æ‹©é€‰é¡¹1: è¿è¡Œè‡ªåŠ¨æ•°æ®æ”¶é›†ï¼ˆåŒ…å«æ•°æ®è¿‡æ»¤ï¼‰
```

### æ–¹æ³•2: ç‹¬ç«‹è¿‡æ»¤æŒç»­æŒ‡æ ‡æ–‡ä»¶
ä¸“é—¨è¿‡æ»¤æŒç»­æŒ‡æ ‡æ–‡ä»¶ï¼š

```bash
cd /Users/admin/Workspace/python/emqtt-bench-huawei/metrics
python3 filter_continuous_metrics.py
```

### æ–¹æ³•3: ä½¿ç”¨ä¸»ç¨‹åºçš„è¿‡æ»¤é€‰é¡¹
```bash
cd /Users/admin/Workspace/python/emqtt-bench-huawei/metrics
python3 main.py
# é€‰æ‹©é€‰é¡¹3: è¿‡æ»¤æŒç»­æŒ‡æ ‡æ–‡ä»¶
```

## è¾“å‡ºæ–‡ä»¶

### è¿‡æ»¤åçš„æ–‡ä»¶ä½ç½®
- **æŒç»­æŒ‡æ ‡æ–‡ä»¶**: `metrics/reports/filtered/`
- **æµ‹è¯•æ•°æ®æ–‡ä»¶**: `test_data/filtered_data/`

### æ–‡ä»¶å‘½åè§„åˆ™
- æŒç»­æŒ‡æ ‡: `filtered_continuous_metrics_æµ‹è¯•ç±»å‹_æ—¶é—´æˆ³.json`
- æµ‹è¯•æ•°æ®: `filtered_æµ‹è¯•åç§°_æ—¶é—´æˆ³.json`

## è¿‡æ»¤ç»Ÿè®¡ä¿¡æ¯

æ¯ä¸ªè¿‡æ»¤åçš„æ–‡ä»¶éƒ½åŒ…å«è¯¦ç»†çš„è¿‡æ»¤ç»Ÿè®¡ä¿¡æ¯ï¼š

```json
{
  "filter_info": {
    "original_count": 83636,
    "filtered_count": 3248,
    "removed_count": 80388,
    "filter_timestamp": "2025-01-01T18:49:43.123456"
  }
}
```

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒç»„ä»¶
1. **TestSpecificFilter**: æµ‹è¯•ç‰¹å®šè¿‡æ»¤å™¨ç±»
2. **è¿‡æ»¤è§„åˆ™é…ç½®**: æ¯ç§æµ‹è¯•ç±»å‹çš„æ— æ•ˆæ•°æ®è§„åˆ™
3. **è‡ªåŠ¨é›†æˆ**: é›†æˆåˆ°main.pyçš„æµ‹è¯•æµç¨‹ä¸­

### è¿‡æ»¤é€»è¾‘
1. æ ¹æ®æµ‹è¯•åç§°è¯†åˆ«æµ‹è¯•ç±»å‹
2. åº”ç”¨æµ‹è¯•ç‰¹å®šçš„è¿‡æ»¤è§„åˆ™
3. åº”ç”¨é€šç”¨è¿‡æ»¤è§„åˆ™
4. ä¿ç•™å…³é”®æ€§èƒ½æŒ‡æ ‡
5. ç”Ÿæˆè¿‡æ»¤ç»Ÿè®¡ä¿¡æ¯

## é…ç½®è‡ªå®šä¹‰è¿‡æ»¤è§„åˆ™

å¯ä»¥åœ¨ `test_specific_filter.py` ä¸­ä¿®æ”¹è¿‡æ»¤è§„åˆ™ï¼š

```python
self.test_specific_rules = {
    "åä¸ºäº‘è¿æ¥æµ‹è¯•": {
        "invalid_metrics": [
            "pub_fail", "pub_overrun", "pub_succ", "pub",
            "sub_fail", "sub", "reconnect_succ",
            "publish_latency"
        ],
        "keep_metrics": [
            "connect_succ", "connect_fail", "connect_retried",
            "connection_timeout", "connection_refused", "unreachable",
            "connection_idle", "recv"
        ]
    }
    # ... å…¶ä»–æµ‹è¯•ç±»å‹
}
```

## æ³¨æ„äº‹é¡¹

1. **å¤‡ä»½åŸå§‹æ•°æ®**: è¿‡æ»¤æ“ä½œä¼šåˆ›å»ºæ–°æ–‡ä»¶ï¼ŒåŸå§‹æ•°æ®ä¸ä¼šè¢«ä¿®æ”¹
2. **é‡å¤è¿‡æ»¤**: ç³»ç»Ÿä¼šæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨è¿‡æ»¤åçš„æ–‡ä»¶ï¼Œé¿å…é‡å¤å¤„ç†
3. **æ–‡ä»¶ç¼–ç **: æ”¯æŒä¸­æ–‡æ–‡ä»¶åå’Œå†…å®¹
4. **æ€§èƒ½ä¼˜åŒ–**: è¿‡æ»¤è¿‡ç¨‹ä¼šæ˜¾ç¤ºè¯¦ç»†çš„è¿›åº¦ä¿¡æ¯

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **æ‰¾ä¸åˆ°æ–‡ä»¶**: ç¡®ä¿reportsç›®å½•ä¸­å­˜åœ¨continuous_metrics_*.jsonæ–‡ä»¶
2. **æƒé™é”™è¯¯**: ç¡®ä¿æœ‰å†™å…¥æƒé™åˆ›å»ºfilteredç›®å½•
3. **ç¼–ç é—®é¢˜**: ä½¿ç”¨python3è€Œä¸æ˜¯python2

### è°ƒè¯•æ¨¡å¼
å¯ä»¥å•ç‹¬è¿è¡Œè¿‡æ»¤å™¨è¿›è¡Œè°ƒè¯•ï¼š

```python
from test_specific_filter import TestSpecificFilter
filter_processor = TestSpecificFilter()
filtered_files = filter_processor.auto_filter_all_continuous_files("reports")
```

## æ›´æ–°æ—¥å¿—

- **2025-01-01**: åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒå››ç§æµ‹è¯•ç±»å‹çš„æ™ºèƒ½è¿‡æ»¤
- å®ç°äº†97%çš„æ•°æ®å‹ç¼©ç‡
- é›†æˆåˆ°ä¸»ç¨‹åºè‡ªåŠ¨åŒ–æµç¨‹
- æ”¯æŒä¸­æ–‡æ–‡ä»¶åå¤„ç†
